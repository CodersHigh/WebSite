<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="assets/ico/favicon.ico">

    <title>메시지 익스텐션을 이용한 Calendar-Vot 제작기</title>

    <!-- Bootstrap core CSS -->
    <link href="../assets/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../assets/css/style.css" rel="stylesheet">
    <link href="../assets/css/font-awesome.min.css" rel="stylesheet">


    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="assets/js/modernizr.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        <a class="navbar-brand abc" href="index.html"><img src="../assets/img/codershighLogo.png" class="img-responsive" style="padding-top: 0px;">
        </div>
        <div class="navbar-collapse collapse navbar-right">
          <ul class="nav navbar-nav">
            <li class="active"><a href="index.html" style="font-size: inherit;">홈</a></li>
            <li><a style="font-size: inherit;" href="../about.html">소개</a></li>
            <li><a style="font-size: inherit;"href="../contact.html">문의</a></li>
            <li><a style="font-size: inherit;"href="../techblogs.html">기술블로그</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

	<!-- *****************************************************************************************************************
	 BLUE WRAP
	 ***************************************************************************************************************** -->
	<div id="blue">
	    <div class="container">
			<div class="row">
				<h3>코더스하이 기술블로그</h3>
			</div><!-- /row -->
	    </div> <!-- /container -->
	</div><!-- /blue -->


	<!-- *****************************************************************************************************************
	 BLOG CONTENT
	 ***************************************************************************************************************** -->

	 <div class="container mtb">
	 	<div class="row">

	 		<! -- SINGLE POST -->
	 		<div class="col-lg-12">
	 			<! -- Blog Post 1 -->
		 		<p><img class="img-responsive" src="assets/img/post01.jpg"></p>
		 		<a href="single-post.html"><h3 class="ctitle">메시지 익스텐션을 이용한 Calendar-Vot 제작기</h3></a>
		 		<p><csmall>Posted: April 25, 2014.</csmall> | <csmall2>By: Admin - 3 Comments</csmall2></p>
                <p><span style=" font-size: 1.5em; color: green;">1. iMessage Apps</span><br><br>
                  iOS10 이상의 메시지 앱에서는 iMessage 앱을 이용하여 메시지를 떠나지 않고 여러 작업을 수행하거나, 다양한 스티커 팩을 이용할 수 있습니다. 또한, 메시지 내에 iMessage 앱과 스티커팩을 다운로드 받을 수 있는 메시지 앱 스토어가 따로 있습니다. 사실 iMessage 앱과 스티커팩은 앱이 아니라 '메시지 익
                    스텐션(Message Extension)입니다.<br></p>
                   <p style="text-align: center;"> <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/1-1.png?raw=true" width = 400>
                </p>
                <p>
                메시지 프레임워크(Messages Framework)을 이용하여 메시지 익스탠션을 만들 수 있습니다.<br>
                    메시지앱은 단독으로 개발할 수도 있고, 일반 앱과 연동하여 개발할 수도 있습니다. 대부분의 스티커팩 앱은 메시지 내에만 존재하는 단독 메시지 익스탠션입니다. '에어비앤비' 앱처럼 기존의 앱 기능이 연동되어 메시지 익스탠션으로 제공될 수도 있습니다.<br>
메시지 앱스토어에서 'Stick Man' 앱을 다운받으면 메시지 앱 목록에만 나타납니다. 하지만 '에어비앤비' 앱을 다운받으면 메시지 앱 목록 뿐만 아니라 일반적인 '에어비앤비' 앱이 함께 설치된 것을 볼 수 있습니다.(이 글에서는 단독(standalone) iMessage 앱을 개발한 내용 위주로 다루겠습니다.
                    )<br></p>
                <p style="text-align: center;"> <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/1-2.png?raw=true" width = 700><br>
                </p>
                <p><span style=" font-size: 1.5em; color: green;">1-1. Message Extension 만들기<br><br></span>
                    <b>[새로운 iMessage 앱 만들기]</b><br>
                    새로운 앱을 만들기 위해서는 'iMessage Application' 프로젝트를 생성해야 합니다. 처음 프로젝트를 생성하면 아래와 같은 화면이 나타납니다.<br>
                    <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/1-1-1.png?raw=true" width = 400><br><br>
                    기본적으로 생성되는 MessagesViewController에서 앱의 사용자 인터페이스를 꾸밀 수 있습니다.<br>
                    <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/1-1-2.png?raw=true" width = 900><br><br>
                </p>
                <p><b>[기존에 개발된 앱에 메시지 익스텐션 추가하기]</b><br>
                    이미 제작한 프로젝트가 존재하고, 메시지 앱을 추가하고 싶으면, iMessage Extension 타겟을 추가하면 됩니다.<br>
                    <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/1-1-3.png?raw=true" width = 700><br><br>
                    기존에 개발한 내용(클래스 등)을 메시지 익스텐션에 적용하고 싶을 때, 타겟 멤버십(Target Membership)에 메시지 익스텐션을 추가하면 빌드시에 포함됩니다.<br>
                    <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/1-1-4.png?raw=true" width = 200><br>
                </p>
                <p><b>아이메시지앱도 시뮬레이터에서 테스트 할 수 있습니다.</b> 시뮬레이터를 작동하면 2명의 가상 인물이 메시지를 주고 받는 형식으로 테스트를 할 수 있습니다.<br></p><p style="text-align: center;"> 
                <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/1-1-5.png?raw=true" width = 400><br><br></p>
               
                <p><span style=" font-size: 1.5em; color: green;">1-2. Message Extension을 위한 Class 알아보기<br><br></span>
                    iMessage App을 만들기 위해 사용하는 클래스들을 알아보겠습니다. 주로 사용되는 클래스는 MSMessagesAppViewController, MSConversation, MSMessage, 그리고 MSSession이 있습니다.
                </p>
                <p>
                    <b>1) MSMessagesAppViewController</b><br>이 클래스를 이용하여 앱이 화면에 어떻게 나타날지 구현할 수 있습니다. 기존 iOS 앱의 UIViewController와 같은 역할을 하는 것입니다. 메시지앱의 화면은 presentationStyle에 따라 'compact'와 'expanded'로 구분됩니다. compact는 대화창과 함께 나타나게 되고, expanded는 화면 전체에 나타납니다.<br></p><p style="text-align: center;"> 
                    <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/1-2-1.png?raw=true" width = 400><br><br>
                </p>
                <p>
                    <b>2) MSConversation</b><br>
                    MSConversation클래스를 통해 현재 선택된 대화에서 선택된 메시지, 대화 참여자(uuid) 등에 대한 정보를 얻을 수 있습니다.<br>
                    예를 들어,<br>
                    <span style="color:#DF01D7">func</span> didStartSending(_ message: <span style="color:#A901DB"> MSMessage</span>, conversation:<span style="color:#A901DB"> MSConversation</span>)<br>
                    이 메서드는 사용자가 send버튼을 누르면 호출되며, 현재 선택된 대화의 정보를 MSConversation 객체가 가지고 있습니다.<br>
                </p>
            <p><b>3) MSMessage</b><br>
                    이 클래스를 통해 메시지 앱에서 생성된 정보를 담고 있으며 상호작용이 가능한 메시지를 생성할 수 있습니다.  MSMessage의 'url' 속성은 인코딩된 메시지 앱에서 발생한 정보가 저장되어 있습니다. 그리고 'layout' 속성은 메시지가 어떤 모양으로 보여질지 결정합니다.
                </p>
                <p><b>4) MSSession</b><br>
                    이 클래스를 통해 메시지의 내용을 업데이트 할 수 있습니다. 예를 들어, A사용자가 투표를 생성하고 전송하면, B사용자가 그 메시지를 선택하여 투표 항목을 선택하고 업데이트된 내용을 다시 전송합니다.<br><br></p><p style="text-align: center;"> 
                     <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/1-2-2.png?raw=true" width = 400><br>  
                </p>
            <p><span style=" font-size: 1.5em; color: green;">2. Calendar-Vot 소개</span><br>
                    'Calendar-Vot'은 Messages framework을 사용하여 개발한 아이메시지 앱(프로토타입)입니다.주요 기능은 투표(날짜 및 장소)를 생성하고 공유하는 것 입니다. 또한 투표 결과를 캘린더에 바로 등록할 수 있습니다.<br><br></p><p style="text-align: center;"> 
                    <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-1.png?raw=true" width = 400><br>  
                </p>
                <p style="text-align: right;"> GitHub: https://github.com/ProjectInTheClass/Calendar-Vot<br>
                    Web Site: https://projectintheclass.github.io/Calendar-Vot<br>
                    YouTube: https://youtu.be/bgT3bJK_bNg<br>
                    E-mail: yhr7518@gmail.com<br></p>
                
            <p><span style=" font-size: 1.5em; color: green;">2-1. Messages View Controller:MSMessagesAppViewController</span><br><br>
                Calendar -Vot은 크게 4개의 뷰로 구성되어 있습니다.<br><br>
	<b>1) Start View :</b> 아이메시지 앱 목록에서 Calendar-Vot을 선택했을 때 나타나는 화면입니다.새로운 투표를 생성하거나, 기존 투표 히스토리 목록을 보여주며, Compact 스타일로 보여집니다.<br><br>
	<b>2) Add View:</b> 새로운 투표를 등록하는 화면입니다. 투표 생성자는 투표 이름, 날짜와 장소 항목, 투표 옵션 등을 입력합니다.<br><br>
	<b>3) Vote View:</b> 투표를 진행하는 화면입니다. 메시지로 전송된 투표를 선택하면 나타나는 화면으로, 투표 항목을 선택하고 결과를 전송합니다.<br><br>
	<b>4) Result View: </b>투표 결과를 확인하고 캘린더에 추가하는 화면입니다.<br><br>
그리고 상황에 따라 이 뷰들을 생성하고, 메시지 전송을 담당하는 것이 <b>MessagesViewContoller 클래스입니다.</b></p>
                <p>
                아이메시지 앱을 실행하면 'willBecomeActive' 메서드가 호출되고, 이 안에서 'presentViewController'를 호출하여, 어느 뷰를 생성할지 결정합니다.<br>
                    <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-1-1.png?raw=true" width = 800><br>  
                </p>
                <p>
                    <b>1) StartView 생성:</b> 아이메시지 앱 목록에서 앱을 선택하면 compact 모드로 보여집니다. 
이 때는 StartView를 생성합니다. 뷰의 생성은 instantiateViewController를 통해 이루어집니다.
                    <br><br>
                    <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-1-2.png?raw=true" width = 700><br>  
                </p>
                <p>
                	<b>2) AddView 생성:</b> startView에서 '새로운 투표 생성' 버튼을 누르면 presentation style이 expanded로 바뀝니다.<br>
                    이때는 willTransition 메서드가 호출되고, 이 메서드에서 presentViewController를 호출합니다.<br><br>
	지금은 투표 데이터(voteData)가 존재하지 않기 때문에, 선택문 중 'else' 부분에 해당합니다.<br>
instantiateAddViewController를 통해 뷰를 생성합니다.<br><br>
                <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-1-3.png?raw=true" width = 800><br>  
                </p>
                <p>
                    <b>3) VoteView 생성:</b> Vote 클래스 'Created'라는 구조체 변수가 있습니다. 처음 Vote 객체가 생성되면 Created.isCreated = "false"로 초기화됩니다. 새로 생성된 투표를 저장할 때, 'saveData'라는 메서드가 호출되고, 이때 Created.isCreated = "true"가 됩니다.<br>대화에서 선택된 메시지의 투표 데이터가 있고, isCreated가 true일 때, instantiateVoteViewController가 호출되어 VoteView가 생성됩니다. 이 때 생성되는 뷰컨트롤러의 voteData 로 선택된 메시지의 투표 데이터를 넘겨줍니다.<br>
                    <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-1-4.png?raw=true" width = 800><br><br> 

                </p>
                <p>
                    <b>4) ResultView 생성:
</b> 투표 종료 조건이 만족되면 Created.isCreated = "finish"가 됩니다.<br>
	대화에서 선택된 메시지의 투표 데이터가 있고, isCreated가 finish일 때, instantiateResultViewController가 호출되어 ResultView가 생성됩니다.<br>
                    이 때 생성되는 뷰컨트롤러의 voteData로 선택된 메시지의 투표 데이터를 넘겨주며,SettingVoteResult 메서드를 호출하여 투표 결과를 계산합니다.<br><br>
                    <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-1-5.png?raw=true" width = 700><br>  
                </p>
                <p><b>[참고 - willBecomeActive vs. willTransition]<br></b>
                    앱이 비활성화 되어 있을 때, 앱의 메시지를 선택하면 willBecomeActive가 호출됩니다.반면, 하단에 앱이 실행되고 있을 때 메시지를 선택하면 willTransition이 호출됩니다.
                    <br></p><p style="text-align: center;"> 
                    <img src = "https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-1-6.png?raw=true" width = 400><br>  
                </p>
                <p><span style=" font-size: 1.5em; color: green;">2-2. Start View</span><br><br>
                    Start View는 2개의 프로토타입 셀을 갖는 테이블뷰로 이루어져 있으며, StartViewController에 연결됩니다.<br><br>
                    <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-2-1.png?raw=true" width = 700><br>  
                </p>
                <p>UITableView의 'cellForRowAt'은 테이블뷰에 들어갈 내용을 결정합니다. 이 테이블뷰는 2 개의 섹션으로 이루어져있고,  첫번째 섹션에는 VoteView로 연결되는 셀, 두 번째 섹션에는 투표 히스토리를 보여주는 셀이 나타납니다.<br><br>
                    <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-2-2.png?raw=true" width = 700><br>
                    AddVoteCell이 선택되면  델리게이트가 MessagesViewController 내의 메서드를 호출하여 compact 스타일이 었던 앱을 expanded 스타일로 바꿔줍니다.<br><br>
                     <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-2-3.png?raw=true" width = 450>
                </p>
                <p><span style=" font-size: 1.5em; color: green;">2-3. Add View</span><br><br>
                    AddView는 4개의 섹션을 갖는 테이블뷰로 이루어져있습니다.<br><br>
                     <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-3-1.png?raw=true" width = 700><br><br>
                    <b>1) Title Cell:</b>  첫 번째 섹션에 대한 프로토타입 셀로, 1개의 행을 갖습니다. 텍스트필드의 아울렛을 연결하여 입력된 문자열을 임시 변수에 저장합니다.<br>최종 데이터 저장은 Done 버튼이 눌리면 'saveData' 메서드를 호출하여 입력된 모든 데이터를 검사하며 저장 vote 객체에 저장합니다.<br><br><b>2) Date Cell:</b> 두 번째 섹션에서는 날짜 정보를 입력받습니다. 이번에는 커스텀 셀을 이용합니다. 'DateCell' 클래스를 만들어서 기능을 구현합니다.<br><br>
                    <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-3-2.png?raw=true" width = 600><br>
                </p>
                <p>
                Date Cell의 텍스트필드에 액션을 연결하고, 텍스트 필드 편집 시 'showDatePicker' 메서드가 호출됩니다. 이 메서드에서는 입력을 위해 밑에서 올라오는  input view를 커스터마이징 합니다. UIDatePicker와 UIButton을 서브뷰로 만들어 날짜를 입력할 수 있도록 만듭니다.<br><br>
                    <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-3-3.png?raw=true" width = 800><br>
                </p>
                <p><br><br>섹션 헤더 부분도 단순 문자열이 아닌 UIView로 구성되어 있습니다. 초기에는 입력할 수 있는 행이 3개 주어지는데, + 버튼을 누르면 행의 개수가 증가되어 새로운 항목을 입력할 수 있습니다.<br><br>
                    <span style="color: #000080;">func tableView(_ tableView: UITableView, <b>viewForHeaderInSection</b> section: Int) -> <b>UIView?</b></span><br>
위의 메서드를 이용하여 문자열과 버튼으로 이루어진 UIView 헤더를 만듭니다.<br><br>
                    <span style="color:#000080;">addDateBtn.addTarget(self, action: #selector(self.addRow_date), for: UIControlEvents.touchUpInside)</span><br>
addTarget을 하여 이 버튼이 눌리면 클래스 내에 addRow_date 메서드를 호출하고, 이 메서드에서 행의 개수를 증가시킵니다.<br><br>
                    <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-3-4.png?raw=true" width = 700>
                    <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-3-5.png?raw=true" width = 250><br>
                </p>
                <p><b>3) Location Cell:</b> 세 번째 섹션은 Location Cell로, 장소를 입력받는 텍스트 필드를 가집니다.Date Cell과 마찬가지로 헤더가 UIView로 구성되며,  + 버튼을 눌러 행의 개수를 추가할 수 있습니다.
                </p>
                <p>
                    <b>4) Option Cell:</b> 네 번째 섹션에서는 투표 옵션을 선택할 수 있습니다.<br><span style="color:#000080;">func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath)<br></span>
	위 메서드를 이용해,  선택된 셀의 index path를 알 수 있습니다.<br><br>IndexPath.section == 3 (네 번째 섹션:option) 일 때, 셀이 선택되면 셀의 액세서리타입을 체크마크로 변경합니다.<br><br>
특히 '마감기한 설정' 셀(row == 2)이 선택되면 행의 개수를 증가시키고, row == 3 에 Date Cell을 추가하여 날짜를 선택할 수 있게 합니다.<br><br>
                    <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-3-option.png?raw=true" width = 700><br></p><p style="text-align: center;"> <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-3-6.gif?raw=true" width = 200><br><br></p>
                
                <p>	<b>5) Done 버튼:</b> Done 버튼에 액션을 연결하여, 버튼이 눌리면 saveData 메서드를 호출하고, 테이블뷰의 모든 행을 검사하며 Vote 객체에 정보를 입력된 저장합니다.<br>
                    <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-3-7.png?raw=true" width = 500><br><br>
                </p>
                <p><span style=" font-size: 1.5em; color: green;">2-4. Vote View</span><br><br>
                    Vote View에서는 선택된 메시지 세션의 투표 객체의 정보를 로드하고, 사용자에 의해 선택된 투표 항목의 투표 수를 증가하여 다시 투표 정보를 업데이트 합니다.<br>
테이블뷰는 3개의 세션으로 이루어져 있으며, 각각 투표 이름, 날짜항목, 장소항목을 나타냅니다.<br></p>
                <p style="text-align: center;"><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-4-1.png?raw=true" width = 200></p>
                <p><b>1) Vote Title Cell:</b> 투표 객체를 로드할 때, 저장된 옵션 정보에 따라 '다중선택 가능' 한지 Title Cell에 표시합니다.<br><br>
                    <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-4-2.png?raw=true" width = 700><br>
                </p>
                <p><b>2) Vote Date Cell:</b> 투표 객체 중 날짜 정보를 추출(Date 변수를 String으로 변환)하여 두 번째 섹션에 표시합니다. 옵션 정보 중 '선택지 추가 허용'이 true인 경우에는 헤더 영역에 + 버튼이 나타납니다.<br>이 버튼이 눌리면 Add View에서 한 것과 동일한 방식으로 행의 개수가 추가됩니다.<br>새로 추가된 행은 VoteDateCell이 아닌 NewDateCell이며, Add View 의 Date Cell처럼 텍스트 필드를 누르면  input view에 date picker가 나타납니다.<br>                    <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-4-3.png?raw=true" width = 700><br>
                </p>
                <p>셀이 선택되면 득표수를 증가시키고, 체크마크를 표시합니다.<br>
dateData는 날짜와 득표수를 나타내는 딕셔너리의 배열입니다. (var dateData : [(Date, Int)] = [])<br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-4-4.png?raw=true" width = 600><br><br>
</p>
                <p>	<b>3) Vote Location Cell:</b> 투표 객체 중 장소 정보를 추출하여 세 번째 섹션에 표시합니다. 동작 방식은 Vote Date Cell과 동일합니다.<br><br>
                    <b>4) Done 버튼:</b> Done 버튼에 액션을 연결하여, 버튼을 누르면 saveData 메서드를 호출하고  변경된 득표수를 저장합니다.<br>
                </p>
                
                <p><span style=" font-size: 1.5em; color: green;">2-5. Result View</span><br><br>
                Result View는 투표 종료 조건이 만족되고, 앱의 Present style이 expanded 일 때 생성됩니다.<br>투표 종료 시간은 기본적으로 투표 생성 후 24시간이고, 옵션을 통해 변경할 수도 있습니다.<br>(테스트를 위해 '강제종료' 버튼을 누르면 isCreated == "finish"가 되어 종료 조건을 만족)<br><br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-5-1.png?raw=true" width = 500><br><br>
                </p>
                <p>MessagesViewController에서  instantiateResultViewController(with vote:Vote) 메서드는 ResultViewController의 SettingVoteResult() 를 호출합니다.<br>SettingVoteResult() 에서는 투표 결과를 비교하며 득표수가 최대인 날짜와 장소를 저장합니다.<br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-5-2.png?raw=true" width = 400><br>
                    또한, 저장된 값을 이용해 최종 결과 셀의 배경색을 지정합니다.<br><br>
                    <img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-5-3.png?raw=true" width = 800><br></p>
                <p><b>[캘린더에 이벤트 생성하기]</b><br> Add Calendar Event 버튼을 누르면 연결된 액션에 의해 아래와 같은 메서드가 실행됩니다.<br><br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-5-4.png?raw=true" width = 800><br><br>먼저 캘린더 접근 권한이 있는지 확인합니다. 
권한을 얻은 다음, createEvent메서드를 호출합니다.<br><br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-5-5.png?raw=true" width = 700><br><br>EKEventStore 클래스를 통해 캘린더에 접근할 수 있습니다. EKEventStore 오브젝트를 생성하여 캘린더에 일정 정보를 설정하고 저장합니다.<br><br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-5-6.png?raw=true" width = 600>
                </p>
                <p>시뮬레이터에서 앱을 실행하는 중에 캘린더에 들어가면 에러가 발생하므로, 앱을 종료한 후에 캘린더에 들어가면 일정이 등록된 것을 확인할 수 있습니다.<br></p><p style="text-align: center;"><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/2-5-7.png?raw=true" width = 200></p>
                <p><span style=" font-size: 1.5em; color: green;">3. 메시지에 정보 담아 보내기</span><br><br>
                Vote 객체를 통째로 메시지에 담을 수 있으면 좋겠지만, 전달해야하는 정보를 MSMessage 객체에 담아 보내야 합니다. AddView에서 투표를 생성하는 과정을 통해 메시지에 정보를 담는 방법을 보이겠습니다.<br>AddViewController에서 'Done'버튼을 누르면 델리게이트를 통해 아래와 같은 메서드가 실행됩니다.<br><br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/3-1.png?raw=true" width = 700></p>
                <p>여기서 정보를 MSMessage 객체에 담는 메서드가 composeMessage 입니다.<br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/3-2.png?raw=true" width = 700></p>        
                <p>queryItems에 투표 정보를 적절한 형태로 저장합니다. 메시지는 정보들을 딕셔너리 배열로 저장하며, name(Key)과 value 는 string입니다. 투표 정보는 숫자, 날짜, 문자열 등 다양한 형태의 정보를 포함하므로, 적절히 변환해야합니다.<br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/3-3.png?raw=true" width = 750>
</p>
                <p>queryItems 배열에 정보를 저장하고, 다시 메시지를 받았을 때 정보를 추출하기 위해 모든 정보들의 key값을 기억하고 있어야 합니다.<br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/3-4.png?raw=true" width = 300>
                </p>
                <p>메시지를 받으면,  메시지 고유의 URL을 통해 queryItems를 추출합니다.<br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/3-5.png?raw=true" width = 700></p>
                <p>
                그리고 queryItems의 각 요소를 key 값으로 구분하여 투표 정보를 추출하고 저장합니다.<br><img src ="https://github.com/yhr7518/WebSite/blob/master/techblogs/tb_001_calendarvot/tb001_media/3-6.png?raw=true" width = 450><br><br>
</p>
                <p style="text-align: center;">이것으로 메시지 익스텐션을 이용한 Clendar-Vot 제작기를 모두 마치겠습니다. 아래는 시뮬레이터에서 구동한 앱의 실행 동영상입니다.<b><br><br>Calendar-Vot 실행 화면</b><br>
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/bgT3bJK_bNg" frameborder="0" allowfullscreen></iframe></p>
		 		<div class="spacing"></div>
		 		<h6>SHARE:</h6>
		 		<p class="share">
		 			<a href="#"><i class="fa fa-twitter"></i></a>
		 			<a href="#"><i class="fa fa-facebook"></i></a>
		 			<a href="#"><i class="fa fa-tumblr"></i></a>
		 			<a href="#"><i class="fa fa-google-plus"></i></a>
		 		</p>

			</div><! --/col-lg-8 -->


	 </div><! --/container -->


   <!-- *****************************************************************************************************************
 	 FOOTER
 	 ***************************************************************************************************************** -->
 	 <div id="footerwrap">
 	 	<div class="container">
 		 	<div class="row">
 		 		<div class="col-lg-4">
 		 			<h4>회사 소개</h4>
 		 			<div class="hline-w"></div>
 		 			<p>코더스하이는 iOS/macOS 교육 콘텐츠 제작 그룹입니다.</br>
 		 			코더들이 짜릿한 즐거움을 느끼도록 하는 것이 우리의 목표입니다.</p>
 		 		</div>
 		 		<div class="col-lg-4">
 		 			<h4>소셜 네트워크</h4>
 		 			<div class="hline-w"></div>
 		 			<p>
 		 				<a href="#"><i class="fa fa-facebook"></i></a>
 						<a href="#">
 							<img src="assets/img/mailchimp.png">
 						</a>
 		 			</p>
 		 		</div>
 		 		<div class="col-lg-4">
 		 			<h4>회사 위치</h4>
 		 			<div class="hline-w"></div>
 		 			<p>
 		 				경기도 수원시<br/>
 		 				영통구 광교로 156,<br/>
 		 				광교비즈니스센터 11층<br/>
 		 			</p>
 		 		</div>

 		 	</div><! --/row -->
 	 	</div><! --/container -->
 	 </div><! --/footerwrap -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
	<script src="assets/js/retina-1.1.0.js"></script>
	<script src="assets/js/jquery.hoverdir.js"></script>
	<script src="assets/js/jquery.hoverex.min.js"></script>
	<script src="assets/js/jquery.prettyPhoto.js"></script>
  	<script src="assets/js/jquery.isotope.min.js"></script>
  	<script src="assets/js/custom.js"></script>


  </body>
</html>
